{
  "version": 3,
  "sources": ["../../@lexical/react/LexicalClickableLinkPlugin.dev.mjs"],
  "sourcesContent": ["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport { $isLinkNode } from '@lexical/link';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { $findMatchingParent, isHTMLAnchorElement } from '@lexical/utils';\nimport { getNearestEditorFromDOMNode, $getNearestNodeFromDOMNode, $isElementNode, $getSelection, $isRangeSelection } from 'lexical';\nimport { useEffect } from 'react';\n\n/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nfunction findMatchingDOM(startNode, predicate) {\n  let node = startNode;\n  while (node != null) {\n    if (predicate(node)) {\n      return node;\n    }\n    node = node.parentNode;\n  }\n  return null;\n}\nfunction ClickableLinkPlugin({\n  newTab = true,\n  disabled = false\n}) {\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    const onClick = event => {\n      const target = event.target;\n      if (!(target instanceof Node)) {\n        return;\n      }\n      const nearestEditor = getNearestEditorFromDOMNode(target);\n      if (nearestEditor === null) {\n        return;\n      }\n      let url = null;\n      let urlTarget = null;\n      nearestEditor.update(() => {\n        const clickedNode = $getNearestNodeFromDOMNode(target);\n        if (clickedNode !== null) {\n          const maybeLinkNode = $findMatchingParent(clickedNode, $isElementNode);\n          if (!disabled) {\n            if ($isLinkNode(maybeLinkNode)) {\n              url = maybeLinkNode.sanitizeUrl(maybeLinkNode.getURL());\n              urlTarget = maybeLinkNode.getTarget();\n            } else {\n              const a = findMatchingDOM(target, isHTMLAnchorElement);\n              if (a !== null) {\n                url = a.href;\n                urlTarget = a.target;\n              }\n            }\n          }\n        }\n      });\n      if (url === null || url === '') {\n        return;\n      }\n\n      // Allow user to select link text without follwing url\n      const selection = editor.getEditorState().read($getSelection);\n      if ($isRangeSelection(selection) && !selection.isCollapsed()) {\n        event.preventDefault();\n        return;\n      }\n      const isMiddle = event.type === 'auxclick' && event.button === 1;\n      window.open(url, newTab || isMiddle || event.metaKey || event.ctrlKey || urlTarget === '_blank' ? '_blank' : '_self');\n      event.preventDefault();\n    };\n    const onMouseUp = event => {\n      if (event.button === 1) {\n        onClick(event);\n      }\n    };\n    return editor.registerRootListener((rootElement, prevRootElement) => {\n      if (prevRootElement !== null) {\n        prevRootElement.removeEventListener('click', onClick);\n        prevRootElement.removeEventListener('mouseup', onMouseUp);\n      }\n      if (rootElement !== null) {\n        rootElement.addEventListener('click', onClick);\n        rootElement.addEventListener('mouseup', onMouseUp);\n      }\n    });\n  }, [editor, newTab, disabled]);\n  return null;\n}\n\nexport { ClickableLinkPlugin, ClickableLinkPlugin as default };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;AAYA,mBAA0B;AAU1B,SAAS,gBAAgB,WAAW,WAAW;AAC7C,MAAI,OAAO;AACX,SAAO,QAAQ,MAAM;AACnB,QAAI,UAAU,IAAI,GAAG;AACnB,aAAO;AAAA,IACT;AACA,WAAO,KAAK;AAAA,EACd;AACA,SAAO;AACT;AACA,SAAS,oBAAoB;AAAA,EAC3B,SAAS;AAAA,EACT,WAAW;AACb,GAAG;AACD,QAAM,CAAC,MAAM,IAAI,0BAA0B;AAC3C,8BAAU,MAAM;AACd,UAAM,UAAU,WAAS;AACvB,YAAM,SAAS,MAAM;AACrB,UAAI,EAAE,kBAAkB,OAAO;AAC7B;AAAA,MACF;AACA,YAAM,gBAAgB,4BAA4B,MAAM;AACxD,UAAI,kBAAkB,MAAM;AAC1B;AAAA,MACF;AACA,UAAI,MAAM;AACV,UAAI,YAAY;AAChB,oBAAc,OAAO,MAAM;AACzB,cAAM,cAAc,2BAA2B,MAAM;AACrD,YAAI,gBAAgB,MAAM;AACxB,gBAAM,gBAAgB,oBAAoB,aAAa,cAAc;AACrE,cAAI,CAAC,UAAU;AACb,gBAAI,YAAY,aAAa,GAAG;AAC9B,oBAAM,cAAc,YAAY,cAAc,OAAO,CAAC;AACtD,0BAAY,cAAc,UAAU;AAAA,YACtC,OAAO;AACL,oBAAM,IAAI,gBAAgB,QAAQ,mBAAmB;AACrD,kBAAI,MAAM,MAAM;AACd,sBAAM,EAAE;AACR,4BAAY,EAAE;AAAA,cAChB;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF,CAAC;AACD,UAAI,QAAQ,QAAQ,QAAQ,IAAI;AAC9B;AAAA,MACF;AAGA,YAAM,YAAY,OAAO,eAAe,EAAE,KAAK,aAAa;AAC5D,UAAI,kBAAkB,SAAS,KAAK,CAAC,UAAU,YAAY,GAAG;AAC5D,cAAM,eAAe;AACrB;AAAA,MACF;AACA,YAAM,WAAW,MAAM,SAAS,cAAc,MAAM,WAAW;AAC/D,aAAO,KAAK,KAAK,UAAU,YAAY,MAAM,WAAW,MAAM,WAAW,cAAc,WAAW,WAAW,OAAO;AACpH,YAAM,eAAe;AAAA,IACvB;AACA,UAAM,YAAY,WAAS;AACzB,UAAI,MAAM,WAAW,GAAG;AACtB,gBAAQ,KAAK;AAAA,MACf;AAAA,IACF;AACA,WAAO,OAAO,qBAAqB,CAAC,aAAa,oBAAoB;AACnE,UAAI,oBAAoB,MAAM;AAC5B,wBAAgB,oBAAoB,SAAS,OAAO;AACpD,wBAAgB,oBAAoB,WAAW,SAAS;AAAA,MAC1D;AACA,UAAI,gBAAgB,MAAM;AACxB,oBAAY,iBAAiB,SAAS,OAAO;AAC7C,oBAAY,iBAAiB,WAAW,SAAS;AAAA,MACnD;AAAA,IACF,CAAC;AAAA,EACH,GAAG,CAAC,QAAQ,QAAQ,QAAQ,CAAC;AAC7B,SAAO;AACT;",
  "names": []
}
